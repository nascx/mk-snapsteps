{"version":3,"sources":["../src/commonFunctions/convertExcelToJson.ts"],"names":[],"mappings":";;;;;AAAA,OAAO,gBAAgB;AAAvB,IAEa,oBA+BA;AAjCb;AAAA;AAEO,IAAM,qBAAqB,CAAC,UAAkB,SAAiB;AAClE,UAAI;AACA,cAAM,SAAS;AAAA,UACX;AAAA,YACI,YAAY;AAAA,YACZ,QAAQ,CAAC;AAAA,cACL,MAAM;AAAA,cACN,aAAa;AAAA,gBACT,GAAG;AAAA,gBACH,GAAG;AAAA,gBACH,GAAG;AAAA,gBACH,GAAG;AAAA,gBACH,GAAG;AAAA,gBACH,GAAG;AAAA,gBACH,GAAG;AAAA,cACP;AAAA,YACJ,CAAC;AAAA,UACL;AAAA,QACJ;AACA,cAAM,WAAW,OAAO,GAAG;AAC3B,cAAM,QAAgB,SAAS,CAAC,EAAE;AAClC,cAAM,UAAkB,SAAS,CAAC,EAAE;AACpC,iBAAS,CAAC,EAAE,KAAK;AACjB,cAAM,UAAU,KAAK,UAAU,QAAQ;AACvC,eAAO,EAAE,OAAO,SAAS,SAAS,KAAK;AAAA,MAC3C,SAAS,OAAO;AACZ,gBAAQ,IAAI,EAAE,SAAS,kCAAkC,cAAc,MAAM,CAAC;AAAA,MAClF;AAAA,IACJ;AAGO,IAAM,qCAAqC,CAAC,aAAqB;AACpE,UAAI;AACA,cAAM,SAAS;AAAA,UACX;AAAA,YACI,YAAY;AAAA,YACZ,QAAQ,CAAC;AAAA,cACL,MAAM;AAAA,cACN,aAAa;AAAA,gBACT,GAAG;AAAA,gBACH,GAAG;AAAA,gBACH,GAAG;AAAA,gBACH,GAAG;AAAA,gBACH,GAAG;AAAA,gBACH,GAAG;AAAA,gBACH,GAAG;AAAA,cACP;AAAA,YACJ,CAAC;AAAA,UACL;AAAA,QACJ;AACA,cAAM,WAAW,OAAO,GAAG;AAC3B,cAAM,QAAgB,SAAS,CAAC,EAAE;AAClC,cAAM,UAAkB,SAAS,CAAC,EAAE;AACpC,cAAM,OAAe,SAAS,CAAC,EAAE;AACjC,cAAM,UAAU,KAAK,UAAU,QAAQ;AACvC,eAAO,EAAE,OAAO,SAAS,SAAS,KAAK;AAAA,MAC3C,SAAS,OAAO;AACZ,gBAAQ,IAAI,EAAE,SAAS,kCAAkC,cAAc,MAAM,CAAC;AAAA,MAClF;AAAA,IACJ;AAAA;AAAA","sourcesContent":["import excel2json from 'convert-excel-to-json'\r\n\r\nexport const convertExcelToJson = (listPath: string, line: string) => {\r\n    try {\r\n        const result = excel2json(\r\n            {\r\n                sourceFile: listPath,\r\n                sheets: [{\r\n                    name: '1',\r\n                    columnToKey: {\r\n                        A: 'pm',\r\n                        B: 'page',\r\n                        C: 'it',\r\n                        D: 'activity',\r\n                        E: 'post',\r\n                        F: 'sequence',\r\n                        G: 'operations'\r\n                    }\r\n                }]\r\n            }\r\n        )\r\n        const jsonData = result['1']\r\n        const model: string = jsonData[0].pm\r\n        const product: string = jsonData[1].pm\r\n        jsonData[2].pm = line\r\n        const content = JSON.stringify(jsonData)        \r\n        return { model, product, content, line }\r\n    } catch (error) {\r\n        console.log({ message: 'Error to convert excel to json', errorMessage: error })\r\n    }\r\n}\r\n\r\n\r\nexport const convertExcelToJsonWithoutAlterLine = (listPath: string) => {\r\n    try {\r\n        const result = excel2json(\r\n            {\r\n                sourceFile: listPath,\r\n                sheets: [{\r\n                    name: '1',\r\n                    columnToKey: {\r\n                        A: 'pm',\r\n                        B: 'page',\r\n                        C: 'it',\r\n                        D: 'activity',\r\n                        E: 'post',\r\n                        F: 'sequence',\r\n                        G: 'operations'\r\n                    }\r\n                }]\r\n            }\r\n        )\r\n        const jsonData = result['1']\r\n        const model: string = jsonData[0].pm\r\n        const product: string = jsonData[1].pm\r\n        const line: string = jsonData[2].pm\r\n        const content = JSON.stringify(jsonData) \r\n        return { model, product, content, line }\r\n    } catch (error) {\r\n        console.log({ message: 'Error to convert excel to json', errorMessage: error })\r\n    }\r\n}\r\n"]}