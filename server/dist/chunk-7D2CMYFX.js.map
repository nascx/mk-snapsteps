{"version":3,"sources":["../src/models/production.ts"],"names":[],"mappings":"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","sourcesContent":["import { db } from \"../config/db\";\r\n\r\nexport const getContentFromProductionList = async (model: string, product: string, line: string) => {\r\n    try {\r\n        return new Promise (async (resolve, reject) => {\r\n            const q = 'SELECT content FROM production_lists WHERE model = ? AND product = ? AND line = ?'\r\n            await db.query(q, [model, product, line], (err, data) => {\r\n                if (err) {\r\n                    console.log('Erro ao buscar por lista na tabela de listas de produção: ', err)\r\n                    reject(err)      \r\n                }\r\n                if (data && data.length > 0) {\r\n                    console.log('Dados obtidos com sucesso!')\r\n                    const content = JSON.parse(data[0].content)\r\n                    resolve({status: true, content: content})\r\n                } else {\r\n                    console.log('Não existe uma lista na tabela de listas de produção que satizfaça essa condição.')\r\n                    resolve({status: false, content: []})\r\n                }\r\n            })\r\n        })\r\n    } catch (error) {\r\n        throw error\r\n    }\r\n}\r\n\r\nexport const getContentFromEngineeringList = async (model: string, product: string) => {\r\n    try {\r\n        return new Promise (async (resolve, reject) => {\r\n            const q = 'SELECT content FROM engineering_lists WHERE model = ? AND product = ?'\r\n            await db.query(q, [model, product], (err, data) => {\r\n                if (err) {\r\n                    console.log('Erro ao buscar por lista na tabela de listas de engenharia: ', err)\r\n                    reject(err)      \r\n                }\r\n                if (data && data.length > 0) {\r\n                    console.log('Dados obtidos com sucesso!')\r\n                    const content = JSON.parse(data[0].content)\r\n                    resolve({status: true, content: content})\r\n                } else {\r\n                    console.log('Não existe uma lista na tabela de listas de engenharia que satizfaça essa condição.')\r\n                    resolve({status: false, content: []})\r\n                }\r\n            })\r\n        })\r\n    } catch (error) {\r\n        throw error\r\n    }\r\n}\r\n\r\nexport const searchByModelAndProductOptions = async () => {\r\n    try {\r\n        const q = 'SELECT model, product FROM engineering_lists'\r\n        return new Promise (async (resolve, reject) => {\r\n            await db.query(q, (err, data) => {\r\n                if (err) {\r\n                    console.log('Erro ao buscar por opções de Modelos e produtos')\r\n                    reject(err)\r\n                }\r\n                if (data && data.length > 0) {\r\n                    const models = data.map((row: {model: string }) => {\r\n                        return {label: row.model, value: row.model}\r\n                    })\r\n                    const products = data.map((row: {product: string}) => {\r\n                        return {label: row.product, value: row.product}\r\n                    })\r\n                    resolve({ models, products })\r\n                }\r\n            })\r\n        })\r\n    } catch (error) {\r\n        throw error\r\n    }\r\n}\r\n\r\nexport const searchByModelAndProductOptionsAndLine = async () => {\r\n    try {\r\n        const q = 'SELECT model, product, line FROM production_lists'\r\n        return new Promise (async (resolve, reject) => {\r\n            await db.query(q, (err, data) => {\r\n                if (err) {\r\n                    console.log('Erro ao buscar por opções de Modelos e produtos')\r\n                    reject(err)\r\n                }\r\n                if (data && data.length > 0) {\r\n                    const models = data.map((row: {model: string }) => {\r\n                        return {label: row.model, value: row.model}\r\n                    })\r\n                    const products = data.map((row: {product: string}) => {\r\n                        return {label: row.product, value: row.product}\r\n                    })\r\n                    const lines = data.map((row: {line: string}) => {\r\n                        return {label: row.line, value: row.line}\r\n                    })\r\n                    resolve({models, products, lines})\r\n                }\r\n            })\r\n        })\r\n    } catch (error) {\r\n        throw error\r\n    }\r\n}\r\n\r\n// para procurar se existe uma lista com model e produto e linha iguai na tabela de listas de produção\r\nexport const exsitsThisListInProductionLists = (model: string, product: string, line: string) => {\r\n    try {\r\n        return new Promise(async (resolve, reject) => {\r\n            const q = 'SELECT content FROM production_lists WHERE model = ? AND product = ? AND line = ?'\r\n            const values = [model, product, line]\r\n            await db.query(q, values, (err, data) => {\r\n                if (err) {\r\n                    console.log('Erro ao buscar por lista bna tabela de lista de produção!')\r\n                    reject(err)\r\n                }\r\n                if (data && data.length > 0) {\r\n                    console.log('Existe listas na tabela de listas de engenharia que usam esse modelo e produto')\r\n                    resolve({ status: true, content: data[0].content })\r\n                } else {\r\n                    resolve({ status: false, content: [] })\r\n                }\r\n            })\r\n        })\r\n    } catch (error) {\r\n        throw error\r\n    }\r\n}\r\n\r\n// para criar uma nova lista\r\nexport const saveNewListInProductionLists = async (model: string, product: string, line: string, content: string) => {\r\n    try {\r\n        return new Promise (async (resolve, reject) => {\r\n            const q = 'INSERT INTO production_lists (model, product, line, content) VALUES (?, ?, ?, ?)'\r\n            await db.query(q, [model, product, line, content], (err, data) => {\r\n                if (err) {\r\n                    reject(err)\r\n                }\r\n                if (data && data.affectedRows > 0) {\r\n                    resolve('Dados inseridos com sucesso na tabela de lista de produção!')\r\n                } else {\r\n                    reject('Erro ao inserir os dados na tabela de lista de produção')\r\n                }\r\n            })\r\n        })\r\n    } catch (error) {\r\n        throw error\r\n    }\r\n}\r\n\r\n// para atualizar os dados na lista de produção\r\nexport const updateListInProductionLists = ( model: string, product: string, line: string, content: string) => {\r\n    try {\r\n        return new Promise(async (resolve, reject) => {\r\n            const q = 'UPDATE production_lists SET content = ? WHERE model = ? AND product = ? AND line = ?'\r\n            const values = [content, model, product, line]\r\n            await db.query(q, values, (err, data) => {\r\n                if (err) {\r\n                    console.log('Erro ao atualizar uma lista na tabela de listas de produção!', err)\r\n                    reject(err)\r\n                }\r\n                if (data.affectedRows > 0) {\r\n                    console.log('Arquivos atualizados com sucesso na tabela de lista de produção', data)\r\n                    resolve(true)\r\n                } else {\r\n                    console.log('Por algum motivo os dados não foram atualizados na tabela de lista de produção!')\r\n                    reject('Nenhum dado atualizado na tabela de lista de produção!')\r\n                }\r\n            })\r\n        })\r\n    } catch (error) {\r\n        throw error\r\n    }\r\n}\r\n\r\n\r\n"]}